(function(h){function n(c,f){var b=h.Deferred(),a=f||{},d=new less.Parser(a);(a.imports?k(c):h.Deferred().resolve(c)).done(function(c){d.parse(c,function(d,c){if(d)return b.reject(d);try{b.resolve(c.toCSS(a))}catch(f){b.reject(f)}})});return b.promise()}function k(c){function f(a,b){a=a.replace(/@import\s['"]?(.+?)['"]?\s*;/g,function(a,b){return-1!=a.indexOf("url(")?a:'@import url("'+b+'");'});return a.replace(e,function(a,d){return a.replace(d,j(d,b).url)})}var b=h.Deferred(),a={},d=j(window.location.href).host,
g=/@import\s+url\s*\(['"]?(.+?)['"]?\)\s*;/g,e=/url\s*\(['"]?(.+?)['"]?\)/g;(function p(c){var e=[];c=c.replace(/@import\s['"]?(.+?)['"]?\s*;/g,function(a,b){return-1!=a.indexOf("url(")?a:'@import url("'+b+'");'});c.replace(g,function(b,c){!a[c]&&d==j(c).host&&e.push(function(){return h.ajax({url:c,cache:!1}).done(function(b){a[c]=f(b.replace(/\/\*(?:[^*]|\*+[^\/*])*\*+\/|^((?!:).)?\/\/.*/g,""),c)}).fail(function(b,d,e){a[c]="/* Can't resolve import '"+c+"' ("+d+", "+e+") */"})});return b});var k=
[],l=null;h.each(e,function(a,b){k.push(l=l?l.then(b):b.call())});h.when.apply(h,k).always(function(){c=c.replace(g,function(b,c){return a[c]?a[c]:b});e.length?c=p(c):b.resolve(c)});return c})(f(c.replace(/\/\*(?:[^*]|\*+[^\/*])*\*+\/|^((?!:).)?\/\/.*/g,"")));return b.promise()}function q(c){var f={},b=c.split("\n");c=0;for(max=b.length;c<max;c++){var a=h.trim(b[c]);a.length&&/@[\w\-]+\s*:.[^;]*;/.test(a)&&(a=h.trim(a.replace(";","").replace(/\s+/,"")).split(":"),a[1]=h.trim(a[1].replace(";","").split("//")[0]),
f[a[0]]=a[1])}return f}function r(c,f){return c.replace(/url\s*\(['"]?(.+?)['"]?\)/g,function(b,a){return b.replace(a,m(j(a,f).url,f))})}function m(c,f){var b=j(c),a,d=j(f),g="",e;if(b.host!==d.host)return"";a=Math.max(d.dirs.length,b.dirs.length);for(e=0;e<a&&d.dirs[e]===b.dirs[e];e++);a=b.dirs.slice(e);d=d.dirs.slice(e);for(e=0;e<d.length-1;e++)g+="../";for(e=0;e<a.length-1;e++)g+=a[e]+"/";return g+b.file}function j(c,f){var b=/^((?:[a-z-]+:)?\/\/(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/,
a=c.match(b),d={},g=[];if(!a)throw new Exception("Could not parse url - '"+c+"'");if(!a[1]||a[2]){f||(f=window.location.href);b=f.match(b);if(!b)throw new Exception("Could not parse url - '"+f+"'");a[1]=b[1];a[2]||(a[3]=b[3]+a[3])}if(a[3]){g=a[3].replace("\\","/").split("/");for(b=0;b<g.length;b++)".."===g[b]&&0<b&&(g.splice(b-1,2),b-=2)}d.host=a[1];d.path=a[1]+g.join("/");d.file=a[4]||"";d.query=a[5]||"";d.url=d.path+d.file+d.query;d.dirs=g;return d}h.less=h.less||{getCSS:n,getVars:q,resolveImports:k,
rewriteUrls:r,pathDiff:m,extractUrlParts:j}})(jQuery);
